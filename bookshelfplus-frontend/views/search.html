<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title><%= page + " | " + title; %></title>
    <%- include("./component/header.html"); %>

    <link href="https://cdn.jsdelivr.net/npm/gridjs/dist/theme/mermaid.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/gridjs/dist/gridjs.umd.js"></script>
</head>
<body>

    <h1><%= title %></h1>
    <p>æœ¬ç«™ç”µå­ä¹¦ç”±â€œå¼ å°å¼Ÿä¹‹å®¶â€æ•´ç†ï¼Œå‡ºäºæ–¹ä¾¿å­¦ä¹ ä¹‹ç›®çš„ï¼Œæ‚¨ä»æœ¬ç«™ä¸‹è½½çš„ç”µå­ä¹¦ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œå¦‚éœ€ä»–ç”¨è¯·è”ç³»åŸä½œè€…ã€‚<a href="https://gitee.com/only4/computer-related-books" target="_blank">æŸ¥çœ‹åŒæ­¥æ›´æ–°Giteeä»“åº“</a></p>
    <p>ç”±äºä¿¡æ¯é‡è¾ƒå¤§ï¼Œæˆ‘ä»¬æ— æ³•åšåˆ°ä¸€ä¸€ç¡®è®¤ç›¸å…³ç”µå­ä¹¦çš„æƒå±ç®¡ç†ï¼Œå¦‚æœ¬ç«™ä¸æ…ä¾µçŠ¯äº†æ‚¨çš„æƒåˆ©ï¼Œè¯·å‘é€é‚®ä»¶è‡³<b>contact@only4.work</b>ï¼Œæ¥ä¿¡è¯·æ³¨æ˜ç›¸å…³é“¾æ¥ä»¥åŠæ‚¨çš„ç›¸å…³è¯æ˜ææ–™ï¼Œæˆ‘ä»¬æ”¶åˆ°é‚®ä»¶åä¼šç¬¬ä¸€æ—¶é—´ä¸æ‚¨å–å¾—è”ç³»å¹¶ç§¯æå¤„ç†ï¼Œå¤šè°¢ç†è§£ï¼</p>

    <main class="main">
        <div id="container">
            <div id="cateTable"></div>
            <div id="itemTable"></div>
        </div>
    </main>

    <script>
        function getDefaultGridDictTemplate() {
            return {
                columns: [],
                //data: '',

                // æœç´¢
                search: true,

                // åˆ†é¡µ
                pagination: {
                    limit: 10
                },

                // æ’åº
                sort: true,

                // å¯è°ƒæ•´åˆ—å®½
                resizable: true,

                // è‡ªé€‚åº”
                fixedHeader: true,
                //height: '400px',

                server: {},

                language: {
                    search: {
                        placeholder: 'ğŸ” æœç´¢ä¸€ä¸‹'
                    },
                    pagination: {
                        previous: 'ä¸Šä¸€é¡µ',
                        next: 'ä¸‹ä¸€é¡µ',
                        navigate: (page, pages) => `ç¬¬ ${page} é¡µï¼Œå…± ${pages} é¡µ`,
                        page: (e) => "ç¬¬" + e + "é¡µ",
                        showing: "æ˜¾ç¤ºç»“æœï¼šç¬¬",
                        to: "-",
                        of: "æ¡ç»“æœï¼Œå…±",
                        results: "æ¡ç»“æœ"
                    },
                    sort: {
                        sortAsc: "æŒ‰å‡åºæ’åº",
                        sortDesc: "æŒ‰é™åºæ’åº"
                    },
                    loading: "æ•°æ®æ­£åœ¨åŠ è½½ä¸­...",
                    noRecordsFound: "æ— ç»“æœ",
                    error: "å‡ºé”™äº†"
                },
            };
        }
    </script>
    <script>
        let cateTableDict = getDefaultGridDictTemplate();
        cateTableDict.columns = [
            {
                name: 'åˆ†ç±»',
                sort: true
            },
            {
                name: 'åˆ†ç±»ç®€ä»‹',
                sort: false
            },
            {
                name: 'æ“ä½œ',
                sort: false,
                formatter: (cell, row) => {
                    return gridjs.h('button', {
                        className: 'py-2 mb-4 px-4 border rounded-md text-white bg-blue-600',
                        onClick: () => alert(`Editing "${row.cells[0].data}" "${row.cells[1].data}"`)
                    }, 'æŸ¥çœ‹');
                }
            }
        ];
        cateTableDict.server = {
            url: '/api/getCategoryList?cateLevel=1&parentCateId=', //+'page=1&perpage=20',
            then: data => data.result.reduce((result, element) => {
                //console.log(result, element);
                result.push({
                    åˆ†ç±»: element.cateId,
                    åˆ†ç±»: element.cateName,
                    åˆ†ç±»ç®€ä»‹: element.cateDescription,
                });
                return result;
            }, [ /* reduce resultçš„åˆå§‹å€¼ */])
        };

        let cateTable = new gridjs.Grid(cateTableDict);
        cateTable.render(document.getElementById('cateTable'));
    </script>
    <script>
        let itemTableDict = getDefaultGridDictTemplate();
        itemTableDict.columns = [
            {
                name: 'ä¹¦å',
                sort: true
            },
            {
                name: 'ç®€ä»‹',
                sort: false
            },
            {
                name: 'æ“ä½œ',
                formatter: (cell, row) => {
                    return gridjs.h('button', {
                        className: 'py-2 mb-4 px-4 border rounded-md text-white bg-blue-600',
                        onClick: () => alert(`Editing "${row.cells[0].data}" "${row.cells[1].data}"`)
                    }, 'æŸ¥çœ‹è¯¦æƒ…');
                }
            }
        ];
        itemTableDict.server = {
            url: '/api/getBookList',
            then: data => data.result.reduce((result, element) => {
                result.push({
                    ä¹¦å: element.ä¹¦å,
                    ç®€ä»‹: element.ä¹¦ç±ç®€ä»‹,
                });
                return result;
            }, [ /* reduce resultçš„åˆå§‹å€¼ */])
        };

        let itemTable = new gridjs.Grid(itemTableDict);
        itemTable.render(document.getElementById('itemTable'));
    </script>

    <%- include("./component/footer.html"); %>
</body>
</html>